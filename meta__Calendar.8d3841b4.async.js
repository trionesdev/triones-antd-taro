"use strict";(self.webpackChunk_trionesdev_antd_taro_react=self.webpackChunk_trionesdev_antd_taro_react||[]).push([[9148],{10299:function(a,e,n){var s;n.r(e),n.d(e,{demos:function(){return R}});var f=n(90819),o=n.n(f),T=n(89933),_=n.n(T),r=n(44194),L=n(67443),v=n(77705),d=n(95676),i=n(3837),C=n(92405),D=n(19934),u=n(52920),M=n(14410),y=n(51865),B=n.n(y),k=n(15844),I=n.n(k),x=n(39378),Y=n.n(x),E=n(54090),c=n(18097),P=n(57815),R={"calendar-demo-calendar":{component:r.memo(r.lazy(function(){return n.e(9621).then(n.bind(n,33292))})),asset:{type:"BLOCK",id:"calendar-demo-calendar",refAtomIds:["Calendar"],dependencies:{"index.tsx":{type:"FILE",value:n(62547).Z},react:{type:"NPM",value:"18.3.1"},"../index.tsx":{type:"FILE",value:n(54252).Z},"../../DemoBlock.tsx":{type:"FILE",value:n(92724).Z},"./index.scss":{type:"FILE",value:n(63119).Z},"./calendar-range.tsx":{type:"FILE",value:n(63015).Z},"./calendar.tsx":{type:"FILE",value:n(67950).Z},"./calendar-grid.tsx":{type:"FILE",value:n(32321).Z},"./touchable-calendar-grid.tsx":{type:"FILE",value:n(6699).Z},classnames:{type:"NPM",value:"2.5.1"},"@tarojs/taro":{type:"NPM",value:"4.0.9"},lodash:{type:"NPM",value:"4.17.21"},"../utils/taro-utils.ts":{type:"FILE",value:n(17991).Z},"./style.scss":{type:"FILE",value:n(40096).Z},"./calendar-header.tsx":{type:"FILE",value:n(26254).Z}},entry:"index.tsx"},context:{"../index.tsx":v,"../../DemoBlock.tsx":d,"./index.scss":i,"./calendar-range.tsx":C,"./calendar.tsx":D,"./calendar-grid.tsx":u,"./touchable-calendar-grid.tsx":M,"../utils/taro-utils.ts":E,"./style.scss":c,"./calendar-header.tsx":P,react:s||(s=n.t(r,2)),"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/index.tsx":v,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/DemoBlock/index.tsx":d,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/DemoBlock/index.scss":i,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/calendar-range.tsx":C,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/calendar.tsx":D,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/calendar-grid.tsx":u,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/touchable-calendar-grid.tsx":M,classnames:y,"@tarojs/taro":k,lodash:x,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/utils/taro-utils.ts":E,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/style.scss":c,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/calendar-header.tsx":P},renderOpts:{compile:function(){var m=_()(o()().mark(function g(){var l,p=arguments;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(8506).then(n.bind(n,48506));case 2:return t.abrupt("return",(l=t.sent).default.apply(l,p));case 3:case"end":return t.stop()}},g)}));function h(){return m.apply(this,arguments)}return h}()}},"calendar-demo-grid":{component:r.memo(r.lazy(function(){return n.e(9621).then(n.bind(n,34892))})),asset:{type:"BLOCK",id:"calendar-demo-grid",refAtomIds:["Calendar"],dependencies:{"index.tsx":{type:"FILE",value:n(53449).Z},react:{type:"NPM",value:"18.3.1"},"../../DemoBlock.tsx":{type:"FILE",value:n(92724).Z},"../calendar-grid.tsx":{type:"FILE",value:n(32321).Z},classnames:{type:"NPM",value:"2.5.1"},"./index.scss":{type:"FILE",value:n(63119).Z},lodash:{type:"NPM",value:"4.17.21"},"./style.scss":{type:"FILE",value:n(40096).Z}},entry:"index.tsx"},context:{"../../DemoBlock.tsx":d,"../calendar-grid.tsx":u,"./index.scss":i,"./style.scss":c,react:s||(s=n.t(r,2)),"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/DemoBlock/index.tsx":d,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/calendar-grid.tsx":u,classnames:y,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/DemoBlock/index.scss":i,lodash:x,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/style.scss":c},renderOpts:{compile:function(){var m=_()(o()().mark(function g(){var l,p=arguments;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(8506).then(n.bind(n,48506));case 2:return t.abrupt("return",(l=t.sent).default.apply(l,p));case 3:case"end":return t.stop()}},g)}));function h(){return m.apply(this,arguments)}return h}()}},"calendar-demo-touch-grid":{component:r.memo(r.lazy(function(){return n.e(9621).then(n.bind(n,75923))})),asset:{type:"BLOCK",id:"calendar-demo-touch-grid",refAtomIds:["Calendar"],dependencies:{"index.tsx":{type:"FILE",value:n(82099).Z},react:{type:"NPM",value:"18.3.1"},"../touchable-calendar-grid.tsx":{type:"FILE",value:n(6699).Z},"../../DemoBlock.tsx":{type:"FILE",value:n(92724).Z},"@tarojs/taro":{type:"NPM",value:"4.0.9"},"./index.scss":{type:"FILE",value:n(63119).Z},"../utils/taro-utils.ts":{type:"FILE",value:n(17991).Z},"../Calendar.tsx":{type:"FILE",value:n(54252).Z},"./calendar-range.tsx":{type:"FILE",value:n(63015).Z},"./calendar.tsx":{type:"FILE",value:n(67950).Z},"./calendar-grid.tsx":{type:"FILE",value:n(32321).Z},classnames:{type:"NPM",value:"2.5.1"},lodash:{type:"NPM",value:"4.17.21"},"./style.scss":{type:"FILE",value:n(40096).Z},"./calendar-header.tsx":{type:"FILE",value:n(26254).Z}},entry:"index.tsx"},context:{"../touchable-calendar-grid.tsx":M,"../../DemoBlock.tsx":d,"./index.scss":i,"../utils/taro-utils.ts":E,"../Calendar.tsx":v,"./calendar-range.tsx":C,"./calendar.tsx":D,"./calendar-grid.tsx":u,"./style.scss":c,"./calendar-header.tsx":P,react:s||(s=n.t(r,2)),"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/touchable-calendar-grid.tsx":M,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/DemoBlock/index.tsx":d,"@tarojs/taro":k,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/DemoBlock/index.scss":i,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/utils/taro-utils.ts":E,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/index.tsx":v,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/calendar-range.tsx":C,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/calendar.tsx":D,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/calendar-grid.tsx":u,classnames:y,lodash:x,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/style.scss":c,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Calendar/calendar-header.tsx":P},renderOpts:{compile:function(){var m=_()(o()().mark(function g(){var l,p=arguments;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(8506).then(n.bind(n,48506));case 2:return t.abrupt("return",(l=t.sent).default.apply(l,p));case 3:case"end":return t.stop()}},g)}));function h(){return m.apply(this,arguments)}return h}()}}}},95676:function(a,e,n){n.r(e),n.d(e,{DemoBlock:function(){return T}});var s=n(44194),f=n(3837),o=n(31549),T=function(r){return(0,o.jsxs)("div",{className:"demoBlock",children:[(0,o.jsx)("div",{className:"demoTitle",children:r.title}),(0,o.jsx)("div",{className:"demoMain",style:{padding:"12px 12px",background:"#ffffff"},children:r.children})]})}},3837:function(a,e,n){n.r(e)},98695:function(a,e,n){n.r(e),n.d(e,{texts:function(){return f}});var s=n(67443);const f=[{value:"\u65E5\u5386\u7EC4\u4EF6\uFF0C\u53EF\u4EE5\u901A\u8FC7\u4E0A\u4E0B\u6ED1\u52A8\u5207\u6362\u6708\u4EFD",paraId:0,tocIndex:0}]},32321:function(a,e){e.Z=`import classNames from 'classnames';
import React, {FC, ForwardedRef, forwardRef, memo, useEffect, useMemo, useState} from 'react';
import './style.scss';
import _ from "lodash";

const calendarCls = 'triones-antm-calendar';

export type CalendarGridProps = {
  mouth?: Date;
  /**
   * @description \u503C\uFF0C\u5982\u679C\u662F\u533A\u95F4\u6A21\u5F0F\uFF0C\u5219 0,1 \u7D22\u5F15\u7684\u503C\u6709\u6548\uFF0C0\u662F\u5F00\u59CB\u65F6\u95F4\uFF0C1\u662F\u7ED3\u675F\u65F6\u95F4
   */
  value?: Date[];
  /**
   * @description \u9ED8\u8BA4\u503C\uFF0C\u5982\u679C\u662F\u533A\u95F4\u6A21\u5F0F\uFF0C\u5219 0,1 \u7D22\u5F15\u7684\u503C\u6709\u6548\uFF0C0\u662F\u5F00\u59CB\u65F6\u95F4\uFF0C1\u662F\u7ED3\u675F\u65F6\u95F4
   */
  defaultValue?: Date[];
  onChange?: (value: Date[]) => void;
  /**
   * @description \u662F\u5426\u4E3A\u8303\u56F4\u9009\u62E9
   */
  range?: boolean
  onSelect?: (date: Date) => void;
};

export type CalendarCellProps = {
  mouth?: Date;
  date?: Date;
  value?: Date[];
  range?: boolean
  onSelect?: (date: Date) => void;
};

const CalendarCell: FC<CalendarCellProps> = memo(
  ({
     mouth = new Date(),
     date = new Date(),
     value,
     range,
     onSelect,
   }) => {
    const disabled = useMemo(() => {
      return date.getMonth() !== mouth.getMonth();
    }, [date, mouth]);

    const selected = useMemo(() => {
      if (disabled || _.isEmpty(value)) {
        return false
      }
      if (value?.[0]) {
        value?.[0]?.setHours(0, 0, 0, 0)
      }
      if (value?.[1]) {
        value?.[1]?.setHours(0, 0, 0, 0)
      }

      date.setHours(0, 0, 0, 0);
      if (range) {
        const startDate = value?.[0]
        const endDate = value?.[1]
        console.log('value', value)

        return date.getTime() === startDate?.getTime() || date.getTime() === endDate?.getTime();
      } else {
        return date.getTime() === value?.[0]?.getTime();
      }

    }, [mouth, date, value]);

    const selectedRange = useMemo(() => {
      if (disabled || !range) {
        return false
      }
      const startDate = value?.[0]
      const endDate = value?.[1]
      if (!startDate || !endDate) {
        return false
      }
      date.setHours(0, 0, 0, 0);
      startDate.setHours(0, 0, 0, 0);
      endDate.setHours(0, 0, 0, 0);
      return (
        date.getTime() > startDate!.getTime() &&
        date.getTime() < endDate!.getTime()
      );
    }, [mouth, date, value]);

    return (
      <div
        className={classNames(\`\${calendarCls}-cell\`, {
          [\`\${calendarCls}-cell-disabled\`]: disabled,
          [\`\${calendarCls}-cell-selected\`]: selected,
          [\`\${calendarCls}-cell-selected-range\`]: selectedRange,
        })}
        // style={{ width: size, height: size }}
        onClick={() => {
          onSelect?.(date);
        }}
      >
        <div className={classNames(\`\${calendarCls}-cell-date\`)}>{date.getDate()}</div>
        {date.getDate()===1 && <div className={classNames(\`\${calendarCls}-cell-mouth\`)}>{\`\${(date.getMonth()+1)}\u6708\`}</div>}
      </div>
    );
  },
);

export const CalendarGrid: FC<CalendarGridProps> = memo(forwardRef(({
                                                                  mouth = new Date(),
                                                                  value,
                                                                  defaultValue,
                                                                  range = false,
                                                                  onChange,
                                                                  onSelect
                                                                }, ref: ForwardedRef<any>) => {

  const [innerValue, setInnerValue] = useState(value ?? defaultValue ?? [])

  const handleSelect = (date: Date) => {
    date.setHours(0, 0, 0, 0)
    let _value: Date[] = innerValue
    if (range) {
      if (!_value[0]) {
        _value = [date]
      } else if (!_value[1]) {
        let startDate = _value[0]
        if (date.getTime() < startDate.getTime()) {
          _value = [date, startDate]
        } else {
          _value = [startDate, date]
        }
      }else if (_value[0] && _value[1]) {
        _value = [date]
      }
    } else {
      _value = [date]
    }
    setInnerValue(_value)
    onSelect?.(date)
    onChange?.(_value)
  }

  const cells = useMemo(() => {
    const firstDate = new Date(mouth.getFullYear(), mouth.getMonth(), 1);
    const lastDate = new Date(mouth.getFullYear(), mouth.getMonth() + 1, 0);
    const beforeDays = Array.from({length: firstDate.getDay()}).map(
      (_, index): Date => {
        const date = new Date(firstDate);
        date.setDate(firstDate.getDate() - (firstDate.getDay() - index));
        return date;
      },
    );

    const afterDays = Array.from({length: 6 - lastDate.getDay()}).map(
      (_, index): Date => {
        const date = new Date(lastDate);
        date.setDate(lastDate.getDate() + index + 1);
        return date;
      },
    );
    const mouthDays = Array.from({length: lastDate.getDate()}).map(
      (_, index): Date => {
        const date = new Date(firstDate);
        date.setDate(date.getDate() + index);
        return date;
      },
    );
    return [...beforeDays, ...mouthDays, ...afterDays];
  }, [mouth]);

  useEffect(() => {
    if (value !== undefined) {
      if (value !== innerValue) {
        setInnerValue(value)
      }
    }
  }, [value]);

  return (
    <div ref={ref} className={classNames(\`\${calendarCls}-grid\`)}>
      {cells.map((item, index) => {
        return (
          <CalendarCell
            key={index}
            mouth={mouth}
            date={item}
            value={innerValue}
            range={range}
            onSelect={handleSelect}
          />
        );
      })}
    </div>
  );
}));
`},26254:function(a,e){e.Z='import React from "react";\nimport {FC} from "react";\nimport classNames from "classnames";\n\nconst calendarCls = \'triones-antm-calendar\';\ntype CalendarHeaderProps={\n  mouth: Date;\n  onChange:(mouth:Date)=>void;\n}\nexport const CalendarHeader:FC<CalendarHeaderProps> = ({mouth,onChange}) => {\n  return (<>\n    <div className={classNames(`${calendarCls}-header`)}>\n      <div className={classNames(`${calendarCls}-header-button`)} onClick={() => {\n        onChange(new Date(mouth.getFullYear() - 1, mouth.getMonth(), 1))\n      }}>{`<<`}</div>\n      <div className={classNames(`${calendarCls}-header-button`)} onClick={() => {\n        onChange(new Date(mouth.getFullYear(), mouth.getMonth() - 1, 1))\n      }}>{`<`}</div>\n      <div\n        className={classNames(`${calendarCls}-header-title`)}>{`${mouth.getFullYear()}\u5E74${mouth.getMonth() + 1}\u6708`}</div>\n      <div className={classNames(`${calendarCls}-header-button`)} onClick={() => {\n        onChange(new Date(mouth.getFullYear(), mouth.getMonth() + 1, 1))\n      }}>{`>`}</div>\n      <div className={classNames(`${calendarCls}-header-button`)} onClick={() => {\n        onChange(new Date(mouth.getFullYear() + 1, mouth.getMonth(), 1))\n      }}>{`>>`}</div>\n    </div>\n    <div\n      className={classNames(`${calendarCls}-week`)}>{[`\u65E5`, `\u4E00`, `\u4E8C`, `\u4E09`, `\u56DB`, `\u4E94`, `\u516D`].map((item, index) => {\n      return <div className={classNames(`${calendarCls}-week-cell`)} key={index}>{item}</div>\n    })}</div>\n  </>)\n}\n'},63015:function(a,e){e.Z=`import React, {FC, memo, useEffect, useRef, useState} from "react"
import classNames from "classnames";
import "./style.scss"
import {TouchableCalendarGrid} from "./touchable-calendar-grid";
import {CalendarHeader} from "./calendar-header";
import _ from "lodash";

const calendarCls = 'triones-antm-calendar';

type CalendarProps = {
  mouth?: Date;
  value?: Date[];
  onChange?: (date: Date[]) => void;
}

export const CalendarRange: FC<CalendarProps> = memo(({mouth = new Date(), value, onChange}) => {
  const [currentMouth, setCurrentMouth] = useState(mouth)
  const valueRef = useRef<any>()

  useEffect(() => {
    if (value !== undefined) {
      if (!_.isEqual(value, valueRef.current)) {
        valueRef.current = value
      }
    }
  }, [value]);

  return <div className={classNames(\`\${calendarCls}\`)}>
    <CalendarHeader mouth={currentMouth} onChange={setCurrentMouth}/>
    <TouchableCalendarGrid mouth={currentMouth}
                           value={value ?? valueRef.current ?? []}
                           onMouthChange={setCurrentMouth}
                           onChange={(value) => {
                             valueRef.current = value
                             onChange?.(value)
                           }}
                           range={true}
    />
  </div>
})
`},67950:function(a,e){e.Z=`import React, {FC, memo, useState} from "react"
import classNames from "classnames";
import "./style.scss"
import {TouchableCalendarGrid} from "./touchable-calendar-grid";
import {CalendarHeader} from "./calendar-header";

const calendarCls = 'triones-antm-calendar';

export type CalendarProps = {
  mouth?: Date;
  value?: Date;
  onChange?: (date: Date) => void;
}

export const Calendar: FC<CalendarProps> = memo(({mouth = new Date(), value, onChange}) => {
  const [currentMouth, setCurrentMouth] = useState(mouth)

  return <div className={classNames(\`\${calendarCls}\`)}>
    <CalendarHeader mouth={currentMouth} onChange={setCurrentMouth}/>
    <TouchableCalendarGrid mouth={currentMouth}
                           value={value ? [value] : []}
                           onMouthChange={setCurrentMouth}
                           onChange={(value) => {
                             onChange?.(value?.[0])
                           }}
    />
  </div>
})
`},62547:function(a,e){e.Z=`import React from "react"
import {DemoBlock} from "../../DemoBlock";
import Calendar from "../index";

export default ()=>{
  return <div>
    <DemoBlock title={\`\u57FA\u672C\u4F7F\u7528\`}>
      <Calendar/>
    </DemoBlock>
    <DemoBlock title={\`\u57FA\u672C\u4F7F\u7528\uFF08\u533A\u95F4\u8303\u56F4\uFF09\`}>
      <Calendar.Range/>
    </DemoBlock>
  </div>
}
`},53449:function(a,e){e.Z=`import React from 'react';
import {CalendarGrid} from '../calendar-grid';
import {DemoBlock} from '../../DemoBlock';

export default ()=>{

  return <>
    <DemoBlock title="\u65E5\u5386\u7F51\u683C">
      <CalendarGrid/>
    </DemoBlock>
    <DemoBlock title="\u65E5\u5386\u7F51\u683C(\u533A\u95F4\u9009\u62E9)">
      <CalendarGrid range={true} />
    </DemoBlock>
  </>
}
`},82099:function(a,e){e.Z=`import React from "react";
import {DemoBlock} from "../../DemoBlock";
import {TouchableCalendarGrid} from "../touchable-calendar-grid";



export default () => {
  return <DemoBlock title={\`\u53EF\u624B\u52BF\u4E0A\u4E0B\u6ED1\u52A8\u7684\u65E5\u5386\u7F51\u683C(PC\u7AEF\u9F20\u6807\u6309\u4F4F\u4E0A\u4E0B\u62D6\u62FD)\`}>
    <TouchableCalendarGrid/>
  </DemoBlock>
}
`},54252:function(a,e){e.Z=`import {Calendar as InternalCalendar,CalendarProps} from "./calendar"
import {CalendarGrid,CalendarGridProps} from "./calendar-grid"
import {TouchableCalendarGrid} from "./touchable-calendar-grid"
import {CalendarRange} from "./calendar-range";


export {CalendarGrid, TouchableCalendarGrid}

type CompoundedComponent = typeof InternalCalendar & {
  Range: typeof CalendarRange;
};
const Calendar = InternalCalendar as CompoundedComponent;
Calendar.Range = CalendarRange;

export type {
  CalendarProps,
  CalendarGridProps
}

export default Calendar
`},40096:function(a,e){e.Z=`@import "../style/variable";

$calendarCls: 'triones-antm-calendar';

.#{$calendarCls}-grid {
  //display: flex;
  //flex-wrap: wrap;
  display: grid;
  grid-template-columns: repeat(7, 1fr);
}

.#{$calendarCls}-cell {
  aspect-ratio: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  border-radius: $trionesBorderRadius;
  cursor: default;
  flex-direction: column;

  &-date {
    display: flex;
    width: 100%;
    justify-content: center;
    align-items: center;
  }

  &-mouth {
    display: flex;
    width: 100%;
    justify-content: center;
    align-items: center;
    font-size: 8Px;
  }

  &.#{$calendarCls}-cell {
    &-disabled {
      color: #999999;
    }

    &-selected {
      background-color: $trionesColorPrimary;
      color: white;
    }

    &-selected-range {
      border-radius: 0;
      background-color: $trionesColorPrimaryBg;
      color: black;
    }
  }
}

.#{$calendarCls} {
  &-header {
    display: flex;
    justify-content: space-between;
    align-items: center;

    &-title {
      font-size: 16Px;
      padding: 8Px;
      text-align: center;
    }

    &-button {
      padding-left: 12Px;
      padding-right: 12Px;
      cursor: pointer;
    }
  }

  &-week {
    display: grid;
    grid-template-columns: repeat(7, 1fr);

    &-cell {
      display: flex;
      justify-content: center;
      align-items: center;
      padding-top: 8Px;
      padding-bottom: 8Px;
    }
  }
}
`},6699:function(a,e){e.Z=`import React, {FC, memo, useEffect, useRef, useState} from 'react';
import Taro from '@tarojs/taro'
import {CalendarGrid} from '../Calendar';
import {checkTaroEnv} from "../utils/taro-utils";

type CalendarPickerViewProps = {
  mouth?: Date;
  value?: Date[];
  defaultValue?: Date[];
  onChange?: (value: Date[]) => void;
  onMouthChange?: (mouth: Date) => void;
  range?: boolean
};

/**
 * \u53EF\u4EE5\u624B\u52BF\u6ED1\u52A8\u7684\u65E5\u5386\u7EC4\u4EF6
 */
export const TouchableCalendarGrid: FC<CalendarPickerViewProps> = memo(({
                                                                          mouth = new Date(),
                                                                          value,
                                                                          defaultValue,
                                                                          onChange,
                                                                          onMouthChange,
                                                                          range
                                                                        }) => {
  const isTaroEnv = checkTaroEnv();
  const wrapperRef = useRef<any>()
  const [currentMouth, setCurrentMouth] = useState(mouth);
  let waiting = false;
  const [mouthHeight, setMouthHeight] = useState(200) //\u5F53\u524D\u9009\u4E2D\u7684\u6708\u4EFD\u7684\u5C55\u793A\u9AD8\u5EA6
  const [touching, setTouching] = useState<boolean>(false); //\u662F\u5426\u6B63\u5728\u6ED1\u52A8
  const [touchStartPoint, setTouchStartPoint] = React.useState<any>(); //\u89E6\u6478\u70B9
  const [touchPoint, setTouchPoint] = React.useState<any>(); //\u89E6\u6478\u70B9
  const [translateY, setTranslateY] = useState(0)
  const [mouths, setMouths] = useState<Date[]>([]);

  /**
   * \u8BA1\u7B97\u51FA\u6BCF\u4E2A\u683C\u5B50\u7684\u5927\u5C0F
   */
  const cellSize = async (): Promise<number> => {
    if (isTaroEnv) {
      return await new Promise(resolve => Taro.createSelectorQuery()
        .select(\`#\${wrapperRef.current?.uid}\`).boundingClientRect().exec(res => resolve(res?.[0]?.width / 7)));

    }
    return Promise.resolve(wrapperRef.current?.clientWidth / 7)
  }
  /**
   * \u8BA1\u7B97\u51FA\u6700\u5927\u7684translateY\uFF0C\u9ED8\u8BA4\u4E3AwrapperRef.current?.clientHeight
   */
  const minTranslateY = async (): Promise<number> => {
    if (isTaroEnv) {
      return await new Promise(resolve => {Taro.createSelectorQuery()
        .select(\`#\${wrapperRef.current?.uid}\`).boundingClientRect().exec(res => resolve(res?.[0]?.height))});

    }
    return Promise.resolve(wrapperRef.current?.clientHeight)
  }

  /**
   * \u8BA1\u7B97\u51FA\u8BE5\u6708\u7684\u884C\u6570
   * @param mouth
   */
  const mouthLines = (mouth: Date) => {
    const firstDate = new Date(mouth.getFullYear(), mouth.getMonth(), 1);
    const lastDate = new Date(mouth.getFullYear(), mouth.getMonth() + 1, 0);
    const beforeDays = firstDate.getDay()
    const afterDays = 6 - lastDate.getDay()
    const countDays = beforeDays + lastDate.getDate() + afterDays
    return Math.ceil(countDays / 7)
  }


  const handleInsertMouth = async () => {
    // if (waiting){
    //   return
    // }
    // debugger
    // waiting = true
    const firstMouth = mouths[0];
    const insertMouth = new Date(firstMouth.getFullYear(), firstMouth.getMonth() - 1, 1);
    console.log(insertMouth)
    const newMouths = [insertMouth, ...mouths];
    setMouths(newMouths);
    const insertMouthLines = mouthLines(insertMouth)
    const insertMouthHeight = insertMouthLines * await cellSize()
    setTranslateY(translateY - insertMouthHeight)
    // waiting  = false
  }

  const handleAppendMouth = () => {
    // if (waiting){
    //   return
    // }
    // waiting = true
    const lastMouth = mouths[mouths.length - 1];
    const appendMouth = new Date(lastMouth.getFullYear(), lastMouth.getMonth() + 1, 1);
    const newMouths = [...mouths, appendMouth];
    setMouths(newMouths)
    // waiting = false
  }

  useEffect(() => {
    const initMouths = [
      new Date(currentMouth.getFullYear(), currentMouth.getMonth() - 1, 1),
      new Date(currentMouth.getFullYear(), currentMouth.getMonth(), 1),
      new Date(currentMouth.getFullYear(), currentMouth.getMonth() + 1, 1),
    ]

    Promise.all([]).then(async () => {
      setMouths(initMouths)
      setMouthHeight(mouthLines(currentMouth) * await cellSize())
      const firstMouthHeight = mouthLines(initMouths[0]) * await cellSize()
      setTranslateY(0 - firstMouthHeight)
    })
  }, [currentMouth]);

  useEffect(() => {
    if (mouth !== undefined) {
      if (mouth !== currentMouth) {
        setCurrentMouth(mouth)
      }
    }
  }, [mouth]);

  return <div style={{boxSizing: 'border-box', overflow: 'hidden', height: mouthHeight}}>
    <div ref={wrapperRef} id={wrapperRef.current?.uid}
         style={{transform: \`translate3d(0, \${translateY}px, 0)\`}}
         onTouchStart={(event) => {
           event.preventDefault();
           event.stopPropagation();
           setTouching(true);
           const startPoint = {clientX: event.touches[0].clientX, clientY: event.touches[0].clientY}
           setTouchStartPoint(startPoint)
           setTouchPoint(startPoint);
         }}
         onTouchMove={async (event) => {
           event.preventDefault();
           event.stopPropagation();
           if (touching) {
             const movePoint = {clientX: event.touches[0].clientX, clientY: event.touches[0].clientY}
             if (translateY > 0 || translateY < (0 - await minTranslateY())) {
               return
             }
             console.log("move", movePoint.clientY - touchPoint.clientY)
             const newTranslateY = translateY + (movePoint.clientY - touchPoint.clientY);
             setTranslateY(newTranslateY);
             setTouchPoint(movePoint);
             // console.log(newTranslateY,minTranslateY())
             if (newTranslateY > -10) { //\u5F53\u5411\u4E0B\u6ED1\u52A8\uFF0C\u9876\u90E8\u8DDD\u79BB\u89C6\u7A97\u9876\u90E8\u8DDD\u79BB\u5C0F\u4E8E10\uFF0C\u5219\u63D2\u5165\u4E0A\u4E00\u4E2A\u6708\u4EFD
               console.log("insert")
               await handleInsertMouth()
             } else if (newTranslateY < (0 - (await minTranslateY()) + 10)) { //\u5F53\u5411\u4E0B\u6ED1\u52A8\uFF0C\u5E95\u90E8\u8DDD\u79BB\u89C6\u7A97\u5E95\u90E8\u8DDD\u79BB\u5C0F\u4E8E10\uFF0C\u5219\u8FFD\u52A0\u4E0B\u4E00\u4E2A\u6708\u4EFD
               console.log("append")
               handleAppendMouth()
             }
           }
         }}
         onTouchEnd={async (event) => {
           setTouching(false);
           if (Math.abs(Math.abs(touchStartPoint.clientY) - Math.abs(touchPoint.clientY)) < 5) {
             return
           }


           console.log(mouths)
           let displayMouth;
           //region \u5224\u65AD\u5F53\u524D\u6708\u4EFD\u662F\u5426\u5728\u89C6\u7A97\u5185
           let _mouthHeightSum = 0
           for (let i = 0; i < mouths.length; i++) {
             console.log("mouthHeight", mouthHeight)
             console.log("mouths[i]", mouths[i], i)
             const _mouthHeight = mouthLines(mouths[i]) * await cellSize()
             _mouthHeightSum += _mouthHeight
             console.log("_mouthHeightSum", _mouthHeightSum)
             console.log("translateY", translateY)
             const _topLineY = 0 - (_mouthHeightSum - _mouthHeight) //\u8BE5\u6708\u4EFD\u533A\u57DF\u9876\u90E8\uFF0C\u5BF9\u4E8E\u9876\u70B9\u7684\u504F\u79FB\u91CF
             console.log("_topLineY", _topLineY)
             if (_topLineY <= translateY && _topLineY >= (translateY - mouthHeight)) { //\u8BE5\u6708\u4EFD\u533A\u57DF\u7684\u9876\u90E8\u5728\u89C6\u7A97\u5185
               console.log("top_in")
               const _windowDisplayHeight = _mouthHeightSum - (0 - translateY) //\u8BE5\u6708\u4EFD\u533A\u57DF\u5E95\u90E8\u8DDD\u79BB\u89C6\u7A97\u9876\u90E8\u7684\u8DDD\u79BB
               console.log("_windowDisplayHeight\u2014\u2014top", _windowDisplayHeight)
               if (_windowDisplayHeight >= (mouthHeight / 2)) {

                 console.log("displayMouth", mouths[i])
                 displayMouth = mouths[i]
                 break
               }
             }
             const _bottomLineY = 0 - _mouthHeightSum; //\u8BE5\u6708\u4EFD\u533A\u57DF\u5E95\u90E8\uFF0C\u5BF9\u4E8E\u9876\u70B9\u7684\u504F\u79FB\u91CF
             console.log("_bottomLineY", _bottomLineY)
             if (_bottomLineY <= translateY && _bottomLineY >= (translateY - mouthHeight)) {//\u8BE5\u6708\u4EFD\u533A\u57DF\u7684\u5E95\u90E8\u5728\u89C6\u7A97\u5185
               console.log("bottom_in")
               const _windowDisplayHeight = _mouthHeightSum - (0 - translateY) //\u8BE5\u6708\u4EFD\u533A\u57DF\u5E95\u90E8\u8DDD\u79BB\u89C6\u7A97\u9876\u90E8\u7684\u8DDD\u79BB
               console.log("_windowDisplayHeight-bottom", _windowDisplayHeight)
               if (_windowDisplayHeight >= (mouthHeight / 2)) {

                 console.log("displayMouth", mouths[i])
                 displayMouth = mouths[i]
                 break
               }
             }
           }
           //endregion
           if (displayMouth) {
             setCurrentMouth(displayMouth)
             onMouthChange?.(displayMouth)
           }
         }}
    >
      {
        mouths.map((mouth, index) => (
          <CalendarGrid
            key={index}
            mouth={mouth}
            value={value}
            defaultValue={defaultValue}
            onChange={onChange}
            range={range}
          />
        ))
      }</div>
  </div>;
});
`},63119:function(a,e){e.Z=`.demoBlock {
  font-size: 14px;
  margin-bottom: 12px;
  &:last-of-type {
    padding-bottom: 32px;
  }
  scrollbar-width: thin;
}

.demoTitle {
  padding: 12px 12px 8px;
  color: #697b8c;
  font-size: 14px;
  background: #fafbfc;
}

.demoMain {
  border-right: none;
  border-left: none;
}
`},92724:function(a,e){e.Z=`import React from 'react'
import type { FC, ReactNode } from 'react'
import './index.scss'

interface Props {
  title: string
  padding?: string
  background?: string
  children?: ReactNode
}

export const DemoBlock: FC<Props> = props => {
  return (
    <div className='demoBlock'>
      <div className='demoTitle'>{props.title}</div>
      <div
        className='demoMain'
        style={{
          padding: '12px 12px',
          background: '#ffffff',
        }}
      >
        {props.children}
      </div>
    </div>
  )
}
`},17991:function(a,e){e.Z=`import Taro from '@tarojs/taro'

export const checkTaroEnv = () => {
  const env = Taro.getEnv()
  return env && "Unknown" != env?.toString()
}
`}}]);
