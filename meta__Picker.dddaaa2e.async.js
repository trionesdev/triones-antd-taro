"use strict";(self.webpackChunk_trionesdev_antd_taro_react=self.webpackChunk_trionesdev_antd_taro_react||[]).push([[9710],{95625:function(p,t,n){var P,c;n.r(t),n.d(t,{demos:function(){return K}});var s=n(90819),_=n.n(s),C=n(89933),d=n.n(C),D=n(44194),m=n(71038),O=n(20945),a=n(95676),l=n(42301),k=n(80215),e=n(51865),u=n.n(e),i=n(3837),o=n(39378),y=n.n(o),x=n(27318),R=n(68301),f=n(49632),v=n(4562),V=n(6990),I=n(56321),W=n(36958),T=n(44019),U=n(47323),N=n(93794),S=n(51687),L=n(82281),B=n(78252),K={"picker-demo-base":{component:D.memo(D.lazy(function(){return n.e(9485).then(n.bind(n,81818))})),asset:{type:"BLOCK",id:"picker-demo-base",refAtomIds:["Picker"],dependencies:{"index.tsx":{type:"FILE",value:n(36369).Z},react:{type:"NPM",value:"18.3.1"},"../../Button.tsx":{type:"FILE",value:n(3275).Z},"../../DemoBlock.tsx":{type:"FILE",value:n(92724).Z},"../picker.tsx":{type:"FILE",value:n(76385).Z},"./button.tsx":{type:"FILE",value:n(69387).Z},classnames:{type:"NPM",value:"2.5.1"},"./index.scss":{type:"FILE",value:n(63119).Z},lodash:{type:"NPM",value:"4.17.21"},"./style.scss":{type:"FILE",value:n(69825).Z},"../PickerView.tsx":{type:"FILE",value:n(29023).Z},"../Popup.tsx":{type:"FILE",value:n(5548).Z},"./picker-view.tsx":{type:"FILE",value:n(19971).Z},"./popup.tsx":{type:"FILE",value:n(87949).Z},"react-dom":{type:"NPM",value:"18.3.1"},"./popup-modal.tsx":{type:"FILE",value:n(99144).Z},"./picker-view-column.tsx":{type:"FILE",value:n(38585).Z},"@trionesdev/antd-taro-icons-react":{type:"NPM",value:"0.0.1"},"../SafeArea.tsx":{type:"FILE",value:n(22211).Z},"./picker-view-column-item.tsx":{type:"FILE",value:n(67281).Z},"./safe-area.tsx":{type:"FILE",value:n(65826).Z},"../utils/native-props.ts":{type:"FILE",value:n(27930).Z}},entry:"index.tsx"},context:{"../../Button.tsx":O,"../../DemoBlock.tsx":a,"../picker.tsx":l,"./button.tsx":k,"./index.scss":i,"./style.scss":x,"../PickerView.tsx":R,"../Popup.tsx":f,"./picker-view.tsx":v,"./popup.tsx":V,"./popup-modal.tsx":W,"./picker-view-column.tsx":T,"../SafeArea.tsx":N,"./picker-view-column-item.tsx":S,"./safe-area.tsx":L,"../utils/native-props.ts":B,react:P||(P=n.t(D,2)),"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Button/index.tsx":O,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/DemoBlock/index.tsx":a,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Picker/picker.tsx":l,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Button/button.tsx":k,classnames:e,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/DemoBlock/index.scss":i,lodash:o,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/SafeArea/style.scss":x,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/PickerView/index.tsx":R,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Popup/index.tsx":f,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/PickerView/picker-view.tsx":v,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Popup/popup.tsx":V,"react-dom":c||(c=n.t(I,2)),"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/Popup/popup-modal.tsx":W,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/PickerView/picker-view-column.tsx":T,"@trionesdev/antd-taro-icons-react":U,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/SafeArea/index.tsx":N,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/PickerView/picker-view-column-item.tsx":S,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/SafeArea/safe-area.tsx":L,"/home/runner/work/triones-antd-taro/triones-antd-taro/packages/antd-taro-react/src/utils/native-props.ts":B},renderOpts:{compile:function(){var w=d()(_()().mark(function M(){var E,A=arguments;return _()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.e(8506).then(n.bind(n,48506));case 2:return r.abrupt("return",(E=r.sent).default.apply(E,A));case 3:case"end":return r.stop()}},M)}));function j(){return w.apply(this,arguments)}return j}()}}}},42301:function(p,t,n){n.r(t),n.d(t,{Picker:function(){return k}});var P=n(45332),c=n.n(P),s=n(44194),_=n(49632),C=n(51865),d=n.n(C),D=n(39378),m=n.n(D),O=n(68301),a=n(31549),l="triones-antm-picker",k=s.memo(function(e){var u=e.open,i=e.afterOpenChange,o=e.title,y=e.columns,x=e.labelInValue,R=x===void 0?!1:x,f=e.value,v=e.onOk,V=e.onCancel,I=e.onClose,W=(0,s.useState)(f||Array.from({length:m().size(y)}).map(function(){return null})),T=c()(W,2),U=T[0],N=T[1],S=s.useState(u||!1),L=c()(S,2),B=L[0],K=L[1],w=function(){K(!1),I==null||I()},j=function(){v==null||v(U),w()},M=function(){V==null||V(),w()};return(0,s.useEffect)(function(){i==null||i(B)},[B]),(0,s.useEffect)(function(){u!=null&&u!=B&&K(u)},[u]),(0,a.jsx)(_.default,{open:B,afterOpenChange:function(A){K(A)},styles:{body:{borderTopLeftRadius:6,borderTopRightRadius:6}},children:(0,a.jsxs)("div",{className:d()(l),children:[(0,a.jsxs)("div",{className:d()("".concat(l,"-header")),children:[(0,a.jsx)("a",{className:d()("".concat(l,"-header-button")),onClick:M,children:"\u53D6\u6D88"}),o&&(0,a.jsx)("div",{className:d()("".concat(l,"-header-title")),children:o}),(0,a.jsx)("a",{className:d()("".concat(l,"-header-button")),onClick:j,children:"\u786E\u5B9A"})]}),(0,a.jsx)("div",{className:d()("".concat(l,"-body")),children:(0,a.jsx)(O.default,{columns:y,labelInValue:R,value:U,onChange:function(A){N(A)}})})]})})})},68301:function(p,t,n){n.r(t);var P=n(4562);t.default=P.PickerView},51687:function(p,t,n){n.r(t),n.d(t,{PickerViewColumnItem:function(){return d}});var P=n(51865),c=n.n(P),s=n(44194),_=n(31549),C="triones-antm-picker-view",d=function(m){var O=m.option;return(0,_.jsx)("div",{className:c()("".concat(C,"-column-item")),children:(0,_.jsx)("div",{className:"".concat(C,"-column-item-label"),children:O.label})})}},44019:function(p,t,n){n.r(t),n.d(t,{PickerViewColumn:function(){return l}});var P=n(45332),c=n.n(P),s=n(44194),_=n(51865),C=n.n(_),d=n(51687),D=n(39378),m=n.n(D),O=n(31549),a="triones-antm-picker-view",l=s.memo(function(k){var e=k.options,u=k.labelInValue,i=k.value,o=k.onChange,y=(0,s.useState)(i||null),x=c()(y,2),R=x[0],f=x[1],v=34,V=0,I=0-v*(m().size(e)-1),W=(0,s.useState)(!1),T=c()(W,2),U=T[0],N=T[1],S=s.useState(),L=c()(S,2),B=L[0],K=L[1],w=(0,s.useState)(0),j=c()(w,2),M=j[0],E=j[1],A=function(r){var h=m().findIndex(e,function(Y){return u?Y.value===r.value:Y.value===r});E(0-h*v)};return(0,s.useEffect)(function(){i!==void 0&&i!==R&&(f(i),A(i))},[i]),(0,s.useEffect)(function(){if(i)A(i);else{var g=u?e==null?void 0:e[0]:e==null?void 0:e[0].value;f(g||null),o==null||o(g||null),A(g)}},[e]),(0,O.jsx)("div",{className:C()("".concat(a,"-column")),children:(0,O.jsx)("div",{className:C()("".concat(a,"-column-wheel")),style:{transform:"translate3d(0, ".concat(M,"px, 0)")},onTouchStart:function(r){N(!0);var h={clientX:r.touches[0].clientX,clientY:r.touches[0].clientY};K(h)},onTouchMove:function(r){if(U){var h={clientX:r.touches[0].clientX,clientY:r.touches[0].clientY};if(M>V||M<I)return;E(M+(h.clientY-B.clientY)),K(h)}},onTouchEnd:function(r){N(!1);var h=0;if(M>0)E(0),h=0;else if(M<0-v*(m().size(e)-1))E(0-v*(m().size(e)-1)),h=m().size(e)-1;else{var Y=Math.abs(Math.round(M/v));E(0-Y*v),h=Y}console.log("selectIndex",h);var F=u?e==null?void 0:e[h]:e==null?void 0:e[h].value;f(F),o==null||o(F)},children:!m().isEmpty(e)&&(e==null?void 0:e.map(function(g,r){return(0,O.jsx)(d.PickerViewColumnItem,{option:g},"view-column-".concat(r))}))})})})},4562:function(p,t,n){n.r(t),n.d(t,{PickerView:function(){return k}});var P=n(45332),c=n.n(P),s=n(51865),_=n.n(s),C=n(39378),d=n.n(C),D=n(44019),m=n(44194),O=n(18310),a=n(31549),l="triones-antm-picker-view",k=m.memo(function(e){var u=e.columns,i=e.labelInValue,o=e.value,y=e.onChange,x=(0,m.useState)(o||Array.from({length:d().size(u)}).map(function(){return null})),R=c()(x,2),f=R[0],v=R[1];return(0,m.useEffect)(function(){o!=null&&o!=f&&v(o)},[o]),(0,a.jsxs)("div",{className:_()("".concat(l)),children:[!d().isEmpty(u)&&(u==null?void 0:u.map(function(V,I){return(0,a.jsx)(D.PickerViewColumn,{labelInValue:i,options:V,value:o==null?void 0:o[I],onChange:function(T){f[I]=T,y==null||y(f)}},"column-".concat(I))})),(0,a.jsxs)("div",{className:_()("".concat(l,"-mask")),children:[(0,a.jsx)("div",{className:_()("".concat(l,"-mask-top"))}),(0,a.jsx)("div",{className:_()("".concat(l,"-mask-middle"))}),(0,a.jsx)("div",{className:_()("".concat(l,"-mask-bottom"))})]})]})})},18310:function(p,t,n){n.r(t)},30227:function(p,t,n){n.r(t),n.d(t,{texts:function(){return c}});var P=n(71038);const c=[]},36369:function(p,t){t.Z=`import React from "react"
import {DemoBlock} from "../../DemoBlock";
import {Picker} from "../picker";
import Button from "../../Button";

export default () => {
  const [open, setOpen] = React.useState(false);
  const basicColumns = [
    [
      {label: '\u5468\u4E00', value: 'Mon'},
      {label: '\u5468\u4E8C', value: 'Tues'},
      {label: '\u5468\u4E09', value: 'Wed'},
      {label: '\u5468\u56DB', value: 'Thur'},
      {label: '\u5468\u4E94', value: 'Fri'},
    ],
    [
      {label: '\u4E0A\u5348', value: 'am'},
      {label: '\u4E0B\u5348', value: 'pm'},
    ],
  ]
  return <>
    <DemoBlock title={\`\u57FA\u672C\u4F7F\u7528\`}>
      <Picker open={open} afterOpenChange={(o) => {
        setOpen(o);
      }} columns={basicColumns} value={["Fri"]} onOk={(v)=>{
        console.log(v)
      }}/>
      <Button block={true} onClick={() => {
        setOpen(true);
      }}>\u9009\u62E9</Button>
    </DemoBlock>
  </>
}
`},76385:function(p,t){t.Z=`import React, {FC, useEffect, useState} from "react"
import Popup from "../Popup";
import classNames from "classnames";
import "./style.scss"
import _ from "lodash";
import PickerView, {PickerColumnOption} from "../PickerView";

const pickerCls = "triones-antm-picker";

export type PickerProps = {
  open?: boolean
  afterOpenChange?: (open: boolean) => void;
  title?: React.ReactNode
  columns?: PickerColumnOption[][]
  /**
   * @description \u662F\u5426\u628A\u6BCF\u4E2A\u9009\u9879\u7684 label \u5305\u88C5\u5230 value \u4E2D\uFF0C\u4F1A\u628A Select \u7684 value \u7C7B\u578B\u4ECE string \u53D8\u4E3A { value: string, label: ReactNode } \u7684\u683C\u5F0F
   * @default false
   */
  labelInValue?: boolean
  value?: any[],
  onOk: (value: any[]) => void,
  onCancel?: () => void,
  onClose?: () => void,
}

export const Picker: FC<PickerProps> = React.memo(({
                                                     open,
                                                     afterOpenChange,
                                                     title,
                                                     columns,
                                                     labelInValue = false,
                                                     value, onOk,
                                                     onCancel,
                                                     onClose
                                                   }) => {
  const [internalValue, setInternalValue] = useState(value || Array.from({length: _.size(columns)}).map(() => null))
  const [innerOpen, setInnerOpen] = React.useState(open || false);
  const handleClose = () => {
    setInnerOpen(false)
    onClose?.()
  }
  const handleOk = () => {
    onOk?.(internalValue)
    handleClose()
  }

  const handelCancel = () => {
    onCancel?.()
    handleClose()
  }

  useEffect(() => {
    afterOpenChange?.(innerOpen)
  }, [innerOpen]);

  useEffect(() => {
    if (open == undefined) {
      return;
    }
    if (open == innerOpen) {
      return;
    }
    setInnerOpen(open)
  }, [open]);

  return <Popup open={innerOpen} afterOpenChange={(o)=>{setInnerOpen(o)}} styles={{
    body: {
      borderTopLeftRadius: 6,
      borderTopRightRadius: 6,
    }
  }}>
    <div className={classNames(pickerCls)}>
      <div className={classNames(\`\${pickerCls}-header\`)}>
        <a className={classNames(\`\${pickerCls}-header-button\`)} onClick={handelCancel}>\u53D6\u6D88</a>
        {title && <div className={classNames(\`\${pickerCls}-header-title\`)}>{title}</div>}
        <a className={classNames(\`\${pickerCls}-header-button\`)} onClick={handleOk}>\u786E\u5B9A</a>
      </div>
      <div className={classNames(\`\${pickerCls}-body\`)}>
        <PickerView columns={columns}
                    labelInValue={labelInValue}
                    value={internalValue}
                    onChange={(v) => {
                      setInternalValue(v)
                    }}/>
      </div>
    </div>
  </Popup>
})
`},29023:function(p,t){t.Z=`import {PickerView} from "./picker-view"
import {PickerColumnOption} from "./types"
export type {
  PickerColumnOption
}
export default PickerView
`},67281:function(p,t){t.Z=`import classNames from "classnames";
import React, {FC} from "react";
import { PickerColumnOption} from "./types";

const pickerViewCls = "triones-antm-picker-view";

type PickerViewColumnItemProps = {
  option: PickerColumnOption
}
export const PickerViewColumnItem: FC<PickerViewColumnItemProps> = ({

                                                                      option,
                                                                    }) => {
  return <div className={classNames(\`\${pickerViewCls}-column-item\`)}>
    <div className={\`\${pickerViewCls}-column-item-label\`}>
      {option.label}
    </div>
  </div>
}
`},38585:function(p,t){t.Z=`import React, {FC, useEffect, useState} from "react"
import classNames from "classnames";
import {PickerViewColumnItem} from "./picker-view-column-item";
import _ from "lodash";
import {PickerColumnOption} from "./types";

const pickerViewCls = "triones-antm-picker-view";

type PickerViewColumnProps = {
  options?: PickerColumnOption[]
  labelInValue?: boolean
  value?: any
  onChange?: (value: any, index?: number) => void
}

export const PickerViewColumn: FC<PickerViewColumnProps> = React.memo(
  ({
     options,
     labelInValue,
     value,
     onChange,
   }) => {
    const [internalValue, setInternalValue] = useState<any>(value || null);
    const itemHeight = 34;
    const max = 0;
    const min = 0 - (itemHeight * (_.size(options) - 1));
    const [touching, setTouching] = useState<boolean>(false);
    const [touchPoint, setTouchPoint] = React.useState<any>();
    const [translateY, setTranslateY] = useState(0)

    const handleSelectOption = (selectValue: any) => {
      const valueIndex = _.findIndex(options, (option) => {
        if (labelInValue) {
          return option.value === selectValue.value;
        }
        return option.value === selectValue
      })
      setTranslateY(0 - (valueIndex * itemHeight));
    }

    useEffect(() => {
      if (value === undefined) {
        return;
      }
      if (value === internalValue) {
        return;
      }
      setInternalValue(value)
      handleSelectOption(value)
    }, [value]);

    useEffect(() => {
      if (!value) {
        const selectValue = labelInValue ? options?.[0] : options?.[0].value
        setInternalValue(selectValue || null);
        onChange?.(selectValue || null);
        handleSelectOption(selectValue);
      } else {
        handleSelectOption(value);
      }
    }, [options]);

    return <div className={classNames(\`\${pickerViewCls}-column\`)}>
      <div className={classNames(\`\${pickerViewCls}-column-wheel\`)}
           style={{transform: \`translate3d(0, \${translateY}px, 0)\`}}
           onTouchStart={(event) => {
             setTouching(true);
             const startPoint = {clientX: event.touches[0].clientX, clientY: event.touches[0].clientY}
             setTouchPoint(startPoint);
           }}
           onTouchMove={(event) => {
             if (touching) {
               const movePoint = {clientX: event.touches[0].clientX, clientY: event.touches[0].clientY}
               if (translateY > max || translateY < min) {
                 return;
               }
               setTranslateY(translateY + (movePoint.clientY - touchPoint.clientY));
               setTouchPoint(movePoint);
             }
           }}
           onTouchEnd={(event) => {
             setTouching(false);
             let selectIndex = 0;
             if (translateY > 0) {
               setTranslateY(0);
               selectIndex = 0;
             } else if (translateY < (0 - itemHeight * (_.size(options) - 1))) {
               setTranslateY(0 - itemHeight * (_.size(options) - 1));
               selectIndex = _.size(options) - 1;
             } else {
               const num = Math.abs(Math.round(translateY / itemHeight));
               setTranslateY(0 - num * itemHeight);
               selectIndex = num;
             }
             console.log("selectIndex", selectIndex)
             const selectValue = labelInValue ? options?.[selectIndex] : options?.[selectIndex].value
             setInternalValue(selectValue);
             onChange?.(selectValue);
           }}
      >
        {!_.isEmpty(options) && options?.map((option: any, index: number) => {
          return <PickerViewColumnItem option={option} key={\`view-column-\${index}\`}/>
        })}
      </div>
    </div>
  }
)
`},19971:function(p,t){t.Z=`import classNames from "classnames";
import _ from "lodash";
import {PickerViewColumn} from "./picker-view-column";
import React, {FC, useEffect, useState} from "react";
import { PickerColumnOption} from "./types";
import "./style.scss"

const pickerViewCls = "triones-antm-picker-view";
type PickerViewProps = {
  columns?: PickerColumnOption[][]
  labelInValue?: boolean
  value?: any[]
  onChange?: (value: any[]) => void
}
export const PickerView: FC<PickerViewProps> = React.memo(({columns, labelInValue, value, onChange}) => {
  const [internalValue, setInternalValue] = useState(value || Array.from({length: _.size(columns)}).map(() => null))
  useEffect(() => {
    if (value == undefined) {
      return;
    }
    if (value == internalValue) {
      return;
    }
    setInternalValue(value);
  }, [value]);
  return <div className={classNames(\`\${pickerViewCls}\`)}>
    {!_.isEmpty(columns) && columns?.map((column: any, index: number) => {
      return <PickerViewColumn key={\`column-\${index}\`} labelInValue={labelInValue}
                               options={column}
                               value={value?.[index]}
                               onChange={(v) => {
                                 internalValue[index] = v;
                                 onChange?.(internalValue)
                               }}
      />
    })}
    <div className={classNames(\`\${pickerViewCls}-mask\`)}>
      <div className={classNames(\`\${pickerViewCls}-mask-top\`)}/>
      <div className={classNames(\`\${pickerViewCls}-mask-middle\`)}/>
      <div className={classNames(\`\${pickerViewCls}-mask-bottom\`)}/>
    </div>
  </div>
})
`}}]);
